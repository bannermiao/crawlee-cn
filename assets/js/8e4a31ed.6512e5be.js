"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5872],{141:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>c,default:()=>m,frontMatter:()=>l,metadata:()=>d,toc:()=>h});var a=n(5893),s=n(1151),r=n(5316),i=n(4959);const o={code:"import { PlaywrightCrawler, Dataset } from 'crawlee';\n\nconst crawler = new PlaywrightCrawler({\n    requestHandler: async ({ page, request, enqueueLinks }) => {\n        console.log(`Processing: ${request.url}`);\n        if (request.label === 'DETAIL') {\n            const urlPart = request.url.split('/').slice(-1); // ['sennheiser-mke-440-professional-stereo-shotgun-microphone-mke-440']\n            const manufacturer = urlPart[0].split('-')[0]; // 'sennheiser'\n\n            const title = await page.locator('.product-meta h1').textContent();\n            const sku = await page.locator('span.product-meta__sku-number').textContent();\n\n            const priceElement = page\n                .locator('span.price')\n                .filter({\n                    hasText: '$',\n                })\n                .first();\n\n            const currentPriceString = await priceElement.textContent();\n            const rawPrice = currentPriceString.split('$')[1];\n            const price = Number(rawPrice.replaceAll(',', ''));\n\n            const inStockElement = page\n                .locator('span.product-form__inventory')\n                .filter({\n                    hasText: 'In stock',\n                })\n                .first();\n\n            const inStock = (await inStockElement.count()) > 0;\n\n            const results = {\n                url: request.url,\n                manufacturer,\n                title,\n                sku,\n                currentPrice: price,\n                availableInStock: inStock,\n            };\n\n            // highlight-next-line\n            await Dataset.pushData(results);\n        } else if (request.label === 'CATEGORY') {\n            // We are now on a category page. We can use this to paginate through and enqueue all products,\n            // as well as any subsequent pages we find\n\n            await page.waitForSelector('.product-item > a');\n            await enqueueLinks({\n                selector: '.product-item > a',\n                label: 'DETAIL', // <= note the different label\n            });\n\n            // Now we need to find the \"Next\" button and enqueue the next page of results (if it exists)\n            const nextButton = await page.$('a.pagination__next');\n            if (nextButton) {\n                await enqueueLinks({\n                    selector: 'a.pagination__next',\n                    label: 'CATEGORY', // <= note the same label\n                });\n            }\n        } else {\n            // This means we're on the start page, with no label.\n            // On this page, we just want to enqueue all the category pages.\n\n            await page.waitForSelector('.collection-block-item');\n            await enqueueLinks({\n                selector: '.collection-block-item',\n                label: 'CATEGORY',\n            });\n        }\n    },\n\n    // Let's limit our crawls to make our tests shorter and safer.\n    maxRequestsPerCrawl: 50,\n});\n\nawait crawler.run(['https://warehouse-theme-metal.myshopify.com/collections']);\n",hash:"invalid-token"},l={id:"saving-data",title:"\u4fdd\u5b58\u6570\u636e",sidebar_label:"\u4fdd\u5b58\u6570\u636e",description:"\u4f60\u8fc8\u51fa\u4e86\u4e0eCrawlee\u4e00\u8d77\u8fdb\u884c\u7f51\u7edc\u6293\u53d6\u7684\u7b2c\u4e00\u6b65"},c=void 0,d={id:"introduction/saving-data",title:"\u4fdd\u5b58\u6570\u636e",description:"\u4f60\u8fc8\u51fa\u4e86\u4e0eCrawlee\u4e00\u8d77\u8fdb\u884c\u7f51\u7edc\u6293\u53d6\u7684\u7b2c\u4e00\u6b65",source:"@site/versioned_docs/version-3.6/introduction/07-saving-data.mdx",sourceDirName:"introduction",slug:"/introduction/saving-data",permalink:"/docs/introduction/saving-data",draft:!1,unlisted:!1,tags:[],version:"3.6",sidebarPosition:7,frontMatter:{id:"saving-data",title:"\u4fdd\u5b58\u6570\u636e",sidebar_label:"\u4fdd\u5b58\u6570\u636e",description:"\u4f60\u8fc8\u51fa\u4e86\u4e0eCrawlee\u4e00\u8d77\u8fdb\u884c\u7f51\u7edc\u6293\u53d6\u7684\u7b2c\u4e00\u6b65"},sidebar:"docs",previous:{title:"\u8fdb\u4e00\u6b65\u6293\u53d6",permalink:"/docs/introduction/scraping"},next:{title:"\u91cd\u6784",permalink:"/docs/introduction/refactoring"}},p={},h=[{value:"<code>Dataset.pushData()</code> \u662f\u4ec0\u4e48\uff1f",id:"datasetpushdata-\u662f\u4ec0\u4e48",level:2},{value:"\u67e5\u627e\u5df2\u4fdd\u5b58\u7684\u6570\u636e",id:"\u67e5\u627e\u5df2\u4fdd\u5b58\u7684\u6570\u636e",level:2},{value:"\u4e0b\u4e00\u8282",id:"\u4e0b\u4e00\u8282",level:2}];function u(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.p,{children:"\u6570\u636e\u63d0\u53d6\u5de5\u4f5c\u5982\u679c\u6ca1\u6709\u4fdd\u5b58\u6570\u636e\u4ee5\u4f9b\u5c06\u6765\u4f7f\u7528\u548c\u5904\u7406\uff0c\u5c31\u4e0d\u7b97\u5b8c\u6574\u3002\u6211\u4eec\u5df2\u7ecf\u5230\u8fbe\u4e86\u672c\u6559\u7a0b\u7684\u6700\u540e\u90e8\u5206\uff0c\u4e5f\u662f\u6700\u56f0\u96be\u7684\u90e8\u5206\uff0c\u8bf7\u52a1\u5fc5\u975e\u5e38\u4ed4\u7ec6\u5730\u6ce8\u610f\uff01"}),"\n",(0,a.jsx)(t.p,{children:"\u9996\u5148\uff0c\u5728\u6587\u4ef6\u9876\u90e8\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u5bfc\u5165\uff1a"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",children:"import { PlaywrightCrawler, Dataset } from 'crawlee';\n"})}),"\n",(0,a.jsxs)(t.p,{children:["\u7136\u540e\uff0c\u5c06",(0,a.jsx)(t.code,{children:"console.log(results)"}),"\u8c03\u7528\u66ff\u6362\u4e3a\uff1a"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:"await Dataset.pushData(results);\n"})}),"\n",(0,a.jsx)(t.p,{children:"\u5c31\u662f\u8fd9\u6837\u3002\u4e0e\u4e4b\u524d\u4e0d\u540c\uff0c\u6211\u4eec\u73b0\u5728\u5f88\u8ba4\u771f\u3002\u5c31\u662f\u8fd9\u6837\uff0c\u6211\u4eec\u5b8c\u6210\u4e86\u3002\u6700\u7ec8\u7684\u4ee3\u7801\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a"}),"\n",(0,a.jsx)(r.Z,{className:"language-js",type:"playwright",children:o}),"\n",(0,a.jsxs)(t.h2,{id:"datasetpushdata-\u662f\u4ec0\u4e48",children:[(0,a.jsx)(t.code,{children:"Dataset.pushData()"})," \u662f\u4ec0\u4e48\uff1f"]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(i.Z,{to:"core/class/Dataset#pushData",children:(0,a.jsx)(t.code,{children:"Dataset.pushData()"})}),"\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u7528\u4e8e\u5c06\u6570\u636e\u4fdd\u5b58\u5230\u9ed8\u8ba4\u7684",(0,a.jsx)(i.Z,{to:"core/class/Dataset",children:(0,a.jsx)(t.code,{children:"Dataset"})}),"\u3002 ",(0,a.jsx)(t.code,{children:"Dataset"})," \u662f\u4e00\u4e2a\u8bbe\u8ba1\u7528\u6765\u4ee5\u7c7b\u4f3c\u8868\u683c\u683c\u5f0f\u5b58\u50a8\u6570\u636e\u7684\u5b58\u50a8\u5668\u3002\u6bcf\u6b21\u8c03\u7528 ",(0,a.jsx)(t.code,{children:"Dataset.pushData()"})," \u90fd\u4f1a\u5728\u8868\u683c\u4e2d\u521b\u5efa\u4e00\u884c\u65b0\u8bb0\u5f55\uff0c\u5176\u4e2d\u5c5e\u6027\u540d\u79f0\u5145\u5f53\u5217\u6807\u9898\u3002\u5728\u9ed8\u8ba4\u914d\u7f6e\u4e0b\uff0c\u8fd9\u4e9b\u884c\u88ab\u8868\u793a\u4e3a JSON \u6587\u4ef6\u5e76\u4fdd\u5b58\u5728\u4f60\u7684\u78c1\u76d8\u4e0a\uff0c\u4f46\u4e5f\u53ef\u4ee5\u5c06\u5176\u4ed6\u5b58\u50a8\u7cfb\u7edf\u63d2\u5165\u5230 Crawlee \u4e2d\u3002"]}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["\u6bcf\u6b21\u542f\u52a8Crawlee\u65f6\uff0c\u90fd\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u9ed8\u8ba4\u7684 ",(0,a.jsx)(t.code,{children:"Dataset"})," \uff0c\u56e0\u6b64\u65e0\u9700\u521d\u59cb\u5316\u6216\u5148\u521b\u5efa\u5b9e\u4f8b\u3002\u4f60\u53ef\u4ee5\u521b\u5efa\u4efb\u610f\u6570\u91cf\u7684\u6570\u636e\u96c6\uff0c\u751a\u81f3\u53ef\u4ee5\u4e3a\u5b83\u4eec\u547d\u540d\u3002\u6709\u5173\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605",(0,a.jsx)(t.a,{href:"../guides/result-storage#dataset",children:"\u7ed3\u679c\u5b58\u50a8\u6307\u5357"}),"\u548c",(0,a.jsx)(i.Z,{to:"core/class/Dataset#open",children:(0,a.jsx)(t.code,{children:"Dataset.open()"})}),"\u51fd\u6570\u3002"]})}),"\n",(0,a.jsx)(t.h2,{id:"\u67e5\u627e\u5df2\u4fdd\u5b58\u7684\u6570\u636e",children:"\u67e5\u627e\u5df2\u4fdd\u5b58\u7684\u6570\u636e"}),"\n",(0,a.jsxs)(t.p,{children:["\u9664\u975e\u4f60\u66f4\u6539\u4e86Crawlee\u5728\u672c\u5730\u4f7f\u7528\u7684\u914d\u7f6e\uff0c\u8fd9\u8868\u660e\u4f60\u77e5\u9053\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\uff0c\u5e76\u4e14\u6839\u672c\u4e0d\u9700\u8981\u8fd9\u4e2a\u6559\u7a0b\uff0c\u5426\u5219\u4f60\u5c06\u5728\u7531Crawlee\u521b\u5efa\u8fd0\u884c\u811a\u672c\u7684\u5de5\u4f5c\u76ee\u5f55\u4e2d\u7684",(0,a.jsx)(t.code,{children:"storage"}),"\u76ee\u5f55\u4e2d\u627e\u5230\u4f60\u7684\u6570\u636e\u3002"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"{\u9879\u76ee\u6587\u4ef6\u5939}/storage/datasets/default/\n"})}),"\n",(0,a.jsxs)(t.p,{children:["\u4ee5\u4e0a\u6587\u4ef6\u5939\u5c06\u4fdd\u5b58\u6240\u6709\u5df2\u4fdd\u5b58\u7684\u6570\u636e\uff0c\u4ee5\u7f16\u53f7\u6587\u4ef6\u7684\u5f62\u5f0f\u5b58\u50a8\uff0c\u5c31\u50cf\u5b83\u4eec\u88ab\u63a8\u9001\u5230\u6570\u636e\u96c6\u4e2d\u4e00\u6837\u3002\u6bcf\u4e2a\u6587\u4ef6\u4ee3\u8868\u4e00\u4e2a",(0,a.jsx)(t.code,{children:"Dataset.pushData()"}),"\u7684\u8c03\u7528\u6216\u4e00\u4e2a\u8868\u683c\u884c\u3002"]}),"\n",(0,a.jsx)(t.admonition,{type:"tip",children:(0,a.jsxs)(t.p,{children:["\u5982\u679c\u4f60\u60f3\u5c06\u6570\u636e\u5b58\u50a8\u5728\u4e00\u4e2a\u5927\u6587\u4ef6\u4e2d\uff0c\u800c\u4e0d\u662f\u8bb8\u591a\u5c0f\u6587\u4ef6\u4e2d\uff0c\u8bf7\u53c2\u9605",(0,a.jsx)(t.a,{href:"../guides/result-storage#key-value-store",children:"\u7ed3\u679c\u5b58\u50a8\u6307\u5357"}),"\u4e86\u89e3\u952e\u503c\u5b58\u50a8\u3002"]})}),"\n",(0,a.jsx)(t.h2,{id:"\u4e0b\u4e00\u8282",children:"\u4e0b\u4e00\u8282"}),"\n",(0,a.jsx)(t.p,{children:"\u5728\u4e0b\u4e00\u8bfe\u4e2d\uff0c\u6211\u4eec\u5c06\u5411\u4f60\u5c55\u793a\u4e00\u4e9b\u6539\u8fdb\u63aa\u65bd\uff0c\u53ef\u4ee5\u6dfb\u52a0\u5230\u4f60\u7684\u722c\u866b\u4ee3\u7801\u4e2d\uff0c\u4ece\u800c\u4f7f\u5176\u66f4\u6613\u8bfb\u548c\u66f4\u6613\u7ef4\u62a4\u3002"})]})}function m(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},4959:(e,t,n)=>{n.d(t,{Z:()=>c});n(7294);var a=n(9960),s=n(4477),r=n(2263),i=n(5893),o=n(643).version.split("."),l=[o[0],o[1]].join(".");const c=function(e){var t=e.to,n=e.children,o=(0,s.E)();return(0,r.default)().siteConfig.presets[0][1].docs.disableVersioning||o.version===l?(0,i.jsx)(a.default,{to:"/api/"+t,children:n}):(0,i.jsx)(a.default,{to:"/api/"+("current"===o.version?"next":o.version)+"/"+t,children:n})}},5316:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(3366),s=(n(7294),n(512)),r=n(3e3),i=n(9960);const o={button:"button_YBBj",container:"container_TGAW"};var l=n(5893),c=["children","actor","hash","type"],d={playwright:"6i5QsHBMtm3hKph70",puppeteer:"7tWSD8hrYzuc9Lte7",cheerio:"kk67IcZkKSSBTslXI"};const p=function(e){var t,n=e.children,p=e.actor,h=e.hash,u=e.type,m=(0,a.Z)(e,c);if(h=null!=(t=h)?t:n.hash,!n.code)throw new Error('RunnableCodeBlock requires "code" and "hash" props\nMake sure you are importing the code block contents with the roa-loader.');if(!h)return(0,l.jsx)(r.default,Object.assign({},m,{children:n.code}));var w="https://console.apify.com/actors/"+(null!=p?p:d[null!=u?u:"playwright"])+"?runConfig="+h+"&asrc=run_on_apify";return(0,l.jsxs)("div",{className:(0,s.Z)(o.container,"runnable-code-block"),children:[(0,l.jsxs)(i.default,{href:w,className:o.button,rel:"follow",children:["Run on",(0,l.jsxs)("svg",{width:"91",height:"25",viewBox:"0 0 91 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"apify-logo-light alignMiddle_src-theme-Footer-index-module",children:[(0,l.jsx)("path",{d:"M3.135 2.85A3.409 3.409 0 0 0 .227 6.699l2.016 14.398 8.483-19.304-7.59 1.059Z",fill:"#97D700"}),(0,l.jsx)("path",{d:"M23.604 14.847 22.811 3.78a3.414 3.414 0 0 0-3.64-3.154c-.077 0-.153.014-.228.025l-3.274.452 7.192 16.124c.54-.67.805-1.52.743-2.379Z",fill:"#71C5E8"}),(0,l.jsx)("path",{d:"M5.336 24.595c.58.066 1.169-.02 1.706-.248l12.35-5.211L13.514 5.97 5.336 24.595Z",fill:"#FF9013"}),(0,l.jsx)("path",{d:"M33.83 5.304h3.903l5.448 14.623h-3.494l-1.022-2.994h-5.877l-1.025 2.994h-3.384L33.83 5.304Zm-.177 9.032h4.14l-2-5.994h-.086l-2.054 5.994ZM58.842 5.304h3.302v14.623h-3.302V5.304ZM64.634 5.304h10.71v2.7h-7.4v4.101h5.962v2.632h-5.963v5.186h-3.309V5.303ZM82.116 14.38l-5.498-9.076h3.748l3.428 6.016h.085l3.599-6.016H91l-5.56 9.054v5.569h-3.324v-5.548ZM51.75 5.304h-7.292v14.623h3.3v-4.634h3.993a4.995 4.995 0 1 0 0-9.99Zm-.364 7.417h-3.628V7.875h3.627a2.423 2.423 0 0 1 0 4.846Z",className:"apify-logo",fill:"#000"})]})]}),(0,l.jsx)(r.default,Object.assign({},m,{className:(0,s.Z)(o.codeBlock,"code-block",null!=m.title?"has-title":"no-title"),children:n.code}))]})}},1151:(e,t,n)=>{n.d(t,{Z:()=>o,a:()=>i});var a=n(7294);const s={},r=a.createContext(s);function i(e){const t=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(r.Provider,{value:t},e.children)}},643:e=>{e.exports=JSON.parse('{"name":"crawlee","version":"3.6.2","description":"The scalable web crawling and scraping library for JavaScript/Node.js. Enables development of data extraction and web automation jobs (not only) with headless Chrome and Puppeteer.","engines":{"node":">=16.0.0"},"bin":"./src/cli.ts","main":"./dist/index.js","module":"./dist/index.mjs","types":"./dist/index.d.ts","exports":{".":{"import":"./dist/index.mjs","require":"./dist/index.js","types":"./dist/index.d.ts"},"./package.json":"./package.json"},"keywords":["apify","headless","chrome","puppeteer","crawler","scraper"],"author":{"name":"Apify","email":"support@apify.com","url":"https://apify.com"},"contributors":["Jan Curn <jan@apify.com>","Marek Trunkat <marek@apify.com>","Ondra Urban <ondra@apify.com>"],"license":"Apache-2.0","repository":{"type":"git","url":"git+https://github.com/apify/crawlee"},"bugs":{"url":"https://github.com/apify/crawlee/issues"},"homepage":"https://crawlee.dev","scripts":{"build":"yarn clean && yarn compile && yarn copy","clean":"rimraf ./dist","compile":"tsc -p tsconfig.build.json && gen-esm-wrapper ./dist/index.js ./dist/index.mjs","copy":"tsx ../../scripts/copy.ts"},"publishConfig":{"access":"public"},"dependencies":{"@crawlee/basic":"3.6.2","@crawlee/browser":"3.6.2","@crawlee/browser-pool":"3.6.2","@crawlee/cheerio":"3.6.2","@crawlee/cli":"3.6.2","@crawlee/core":"3.6.2","@crawlee/http":"3.6.2","@crawlee/jsdom":"3.6.2","@crawlee/linkedom":"3.6.2","@crawlee/playwright":"3.6.2","@crawlee/puppeteer":"3.6.2","@crawlee/utils":"3.6.2","import-local":"^3.1.0","tslib":"^2.4.0"},"peerDependencies":{"playwright":"*","puppeteer":"*"},"peerDependenciesMeta":{"playwright":{"optional":true},"puppeteer":{"optional":true}}}')}}]);